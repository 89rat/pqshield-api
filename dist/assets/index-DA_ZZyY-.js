import{r as e,a as s}from"../chunks/vendor-react-CD692ZCr.js";import{S as a,A as t,a as r,B as l,L as c,U as i,b as n,c as d,C as x,d as o,e as m,X as h}from"../chunks/vendor-ui-8rBGN-WC.js";import{R as p,B as u,C as j,X as g,Y as b,T as y,a as N}from"../chunks/vendor-charts-B88lEUWD.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)}).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();var f={exports:{}},v={},w=e,S=Symbol.for("react.element"),k=Symbol.for("react.fragment"),C=Object.prototype.hasOwnProperty,T=w.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,A={key:!0,ref:!0,__self:!0,__source:!0};function P(e,s,a){var t,r={},l=null,c=null;for(t in void 0!==a&&(l=""+a),void 0!==s.key&&(l=""+s.key),void 0!==s.ref&&(c=s.ref),s)C.call(s,t)&&!A.hasOwnProperty(t)&&(r[t]=s[t]);if(e&&e.defaultProps)for(t in s=e.defaultProps)void 0===r[t]&&(r[t]=s[t]);return{$$typeof:S,type:e,key:l,ref:c,props:r,_owner:T.current}}v.Fragment=k,v.jsx=P,v.jsxs=P,f.exports=v;var R,_=f.exports,O=s;R=O.createRoot,O.hydrateRoot;const q=()=>{const[s,f]=e.useState(null),[v,w]=e.useState(!1),[S,k]=e.useState(""),[C,T]=e.useState([]),[A,P]=e.useState([]),[R,O]=e.useState(null),[q,I]=e.useState([]),[L,E]=e.useState("scanner"),[F,Q]=e.useState([]),U=e.useRef(null);e.useEffect(()=>{const e=async()=>{try{const e=await fetch("/api/monitor/threats");if(e.ok){const s=await e.json();T(s.recentThreats||[]),P(s.statistics||[])}}catch(e){}};e();const s=setInterval(e,3e4);return()=>clearInterval(s)},[]);const D=e.useCallback(async()=>{if(S.trim()){w(!0);try{const e=await fetch("/api/scan/code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:S,filePath:"user-input.js",options:{enableNeuralAnalysis:!0,quantumThreatAssessment:!0}})});if(e.ok){const s=await e.json();f(s);const a=await fetch("/api/assess/compliance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({framework:"OWASP",scanResults:s.scan})});if(a.ok){const e=await a.json();O(e)}s.scan.quantumThreats&&I(s.scan.quantumThreats)}}catch(e){}finally{w(!1)}}},[S]),B=e.useCallback(async e=>{const s=Array.from(e.target.files),a=[];for(const r of s){const e=await r.text();a.push({path:r.name,content:e,size:r.size})}if(Q(a),a.length>0){w(!0);try{const e=await fetch("/api/scan/batch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({files:a,options:{enableNeuralAnalysis:!0,quantumThreatAssessment:!0}})});if(e.ok){const s=await e.json();f(s)}}catch(t){}finally{w(!1)}}},[]),K=e=>({critical:"#dc2626",high:"#ea580c",medium:"#d97706",low:"#65a30d",info:"#0891b2"}[e]||"#6b7280"),J=e=>e>=90?"#10b981":e>=70?"#f59e0b":e>=50?"#ef4444":"#dc2626",V=({vulnerability:e})=>_.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 shadow-sm",children:[_.jsxs("div",{className:"flex items-start justify-between",children:[_.jsxs("div",{className:"flex items-center space-x-2",children:[_.jsx(n,{className:"w-5 h-5",style:{color:K(e.severity)}}),_.jsxs("div",{children:[_.jsx("h4",{className:"font-semibold text-gray-900",children:e.type}),_.jsx("p",{className:"text-sm text-gray-600",children:e.description})]})]}),_.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium text-white",style:{backgroundColor:K(e.severity)},children:e.severity.toUpperCase()})]}),_.jsxs("div",{className:"mt-3 space-y-2",children:[_.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[_.jsxs("span",{children:["Line: ",e.line]}),_.jsxs("span",{children:["CWE: ",e.cwe]}),e.quantumThreat&&_.jsxs("span",{className:"flex items-center space-x-1 text-purple-600",children:[_.jsx(c,{className:"w-3 h-3"}),_.jsx("span",{children:"Quantum Threat"})]})]}),e.evidence&&_.jsx("div",{className:"bg-gray-50 rounded p-2",children:_.jsx("code",{className:"text-xs text-gray-700",children:e.evidence})})]})]}),W=({analysis:e})=>_.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-6 border border-blue-200",children:[_.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[_.jsx(d,{className:"w-6 h-6 text-blue-600"}),_.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Neural Network Analysis"})]}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[_.jsxs("div",{className:"text-center",children:[_.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[(100*e.anomalyScore).toFixed(1),"%"]}),_.jsx("div",{className:"text-sm text-gray-600",children:"Anomaly Score"})]}),_.jsxs("div",{className:"text-center",children:[_.jsx("div",{className:"text-2xl font-bold text-purple-600",children:e.threatClassification}),_.jsx("div",{className:"text-sm text-gray-600",children:"Threat Type"})]}),_.jsxs("div",{className:"text-center",children:[_.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[(100*e.confidence).toFixed(1),"%"]}),_.jsx("div",{className:"text-sm text-gray-600",children:"Confidence"})]})]})]}),Y=({threats:e})=>_.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-6 border border-purple-200",children:[_.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[_.jsx(c,{className:"w-6 h-6 text-purple-600"}),_.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Quantum Threats"})]}),0===e.length?_.jsxs("div",{className:"text-center py-4",children:[_.jsx(o,{className:"w-12 h-12 text-green-500 mx-auto mb-2"}),_.jsx("p",{className:"text-gray-600",children:"No quantum vulnerabilities detected"})]}):_.jsx("div",{className:"space-y-3",children:e.map((e,s)=>_.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-200",children:[_.jsxs("div",{className:"flex items-center justify-between mb-2",children:[_.jsx("h4",{className:"font-semibold text-gray-900",children:e.algorithm}),_.jsxs("span",{className:"px-2 py-1 rounded text-xs font-medium "+("high"===e.risk?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:[e.risk.toUpperCase()," RISK"]})]}),_.jsx("p",{className:"text-sm text-gray-600 mb-2",children:e.recommendation}),e.quantumResistantAlternatives&&_.jsxs("div",{className:"text-sm",children:[_.jsx("span",{className:"font-medium text-gray-700",children:"Alternatives: "}),_.jsx("span",{className:"text-blue-600",children:e.quantumResistantAlternatives.join(", ")})]})]},s))})]}),z=({compliance:e})=>_.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:[_.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[_.jsx(a,{className:"w-6 h-6 text-green-600"}),_.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Compliance Status"})]}),e&&_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsx("span",{className:"font-medium",children:e.compliance.framework}),_.jsxs("div",{className:"flex items-center space-x-2",children:[_.jsxs("div",{className:"text-2xl font-bold",style:{color:J(e.compliance.score)},children:[e.compliance.score,"%"]}),_.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium "+("compliant"===e.compliance.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.compliance.status.toUpperCase()})]})]}),e.compliance.details&&_.jsx("div",{className:"grid grid-cols-2 gap-2 text-sm",children:Object.entries(e.compliance.details).map(([e,s])=>_.jsxs("div",{className:"flex items-center space-x-2",children:[s?_.jsx(o,{className:"w-4 h-4 text-green-500"}):_.jsx(h,{className:"w-4 h-4 text-red-500"}),_.jsx("span",{className:"text-gray-700",children:e.replace(/_/g," ")})]},e))})]})]}),H=()=>_.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:[_.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[_.jsx(t,{className:"w-6 h-6 text-red-600"}),_.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Real-Time Threats"})]}),_.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:0===C.length?_.jsxs("div",{className:"text-center py-4",children:[_.jsx(a,{className:"w-12 h-12 text-green-500 mx-auto mb-2"}),_.jsx("p",{className:"text-gray-600",children:"No active threats detected"})]}):C.map((e,s)=>_.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[_.jsx(m,{className:"w-5 h-5 text-red-500"}),_.jsxs("div",{className:"flex-1",children:[_.jsx("div",{className:"font-medium text-gray-900",children:e.vulnerability_type}),_.jsx("div",{className:"text-sm text-gray-600",children:e.file_path})]}),_.jsx("div",{className:"text-xs text-gray-500",children:new Date(e.detected_at).toLocaleTimeString()})]},s))})]});return _.jsxs("div",{className:"min-h-screen bg-gray-50",children:[_.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:_.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:_.jsxs("div",{className:"flex items-center justify-between h-16",children:[_.jsxs("div",{className:"flex items-center space-x-3",children:[_.jsx(a,{className:"w-8 h-8 text-blue-600"}),_.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"PQShield Security Scanner"})]}),_.jsxs("div",{className:"flex items-center space-x-4",children:[_.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[_.jsx(t,{className:"w-4 h-4"}),_.jsx("span",{children:"Real-time Protection Active"})]}),s&&_.jsxs("div",{className:"flex items-center space-x-2",children:[_.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:J(s.scan?.securityScore||0)}}),_.jsxs("span",{className:"text-sm font-medium",children:["Score: ",s.scan?.securityScore||0,"/100"]})]})]})]})})}),_.jsx("div",{className:"bg-white border-b border-gray-200",children:_.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:_.jsx("nav",{className:"flex space-x-8",children:[{id:"scanner",label:"Code Scanner",icon:r},{id:"dashboard",label:"Dashboard",icon:l},{id:"threats",label:"Live Threats",icon:t},{id:"compliance",label:"Compliance",icon:a},{id:"quantum",label:"Quantum Security",icon:c}].map(({id:e,label:s,icon:a})=>_.jsxs("button",{onClick:()=>E(e),className:"flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm "+(L===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[_.jsx(a,{className:"w-4 h-4"}),_.jsx("span",{children:s})]},e))})})}),_.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["scanner"===L&&_.jsxs("div",{className:"space-y-6",children:[_.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Security Code Scanner"}),_.jsxs("div",{className:"flex items-center space-x-3",children:[_.jsx("input",{ref:U,type:"file",multiple:!0,accept:".js,.ts,.jsx,.tsx,.py,.java,.cpp,.c,.php",onChange:B,className:"hidden"}),_.jsxs("button",{onClick:()=>U.current?.click(),className:"flex items-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[_.jsx(i,{className:"w-4 h-4"}),_.jsx("span",{children:"Upload Files"})]})]})]}),_.jsxs("div",{className:"space-y-4",children:[_.jsx("textarea",{value:S,onChange:e=>k(e.target.value),placeholder:"Paste your code here for security analysis...",className:"w-full h-64 p-4 border border-gray-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsx("div",{className:"text-sm text-gray-600",children:F.length>0&&_.jsxs("span",{children:[F.length," files uploaded"]})}),_.jsx("button",{onClick:D,disabled:v||!S.trim()&&0===F.length,className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:v?_.jsxs(_.Fragment,{children:[_.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),_.jsx("span",{children:"Scanning..."})]}):_.jsxs(_.Fragment,{children:[_.jsx(r,{className:"w-4 h-4"}),_.jsx("span",{children:"Scan Code"})]})})]})]})]}),s&&_.jsxs("div",{className:"space-y-6",children:[_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[_.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:_.jsxs("div",{className:"flex items-center space-x-3",children:[_.jsx(a,{className:"w-8 h-8 text-blue-600"}),_.jsxs("div",{children:[_.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.scan?.securityScore||0}),_.jsx("div",{className:"text-sm text-gray-600",children:"Security Score"})]})]})}),_.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:_.jsxs("div",{className:"flex items-center space-x-3",children:[_.jsx(n,{className:"w-8 h-8 text-red-600"}),_.jsxs("div",{children:[_.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.scan?.vulnerabilities?.length||0}),_.jsx("div",{className:"text-sm text-gray-600",children:"Vulnerabilities"})]})]})}),_.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:_.jsxs("div",{className:"flex items-center space-x-3",children:[_.jsx(d,{className:"w-8 h-8 text-purple-600"}),_.jsxs("div",{children:[_.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.scan?.neuralAnalysis?(100*s.scan.neuralAnalysis.anomalyScore).toFixed(0)+"%":"N/A"}),_.jsx("div",{className:"text-sm text-gray-600",children:"AI Anomaly"})]})]})}),_.jsx("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:_.jsxs("div",{className:"flex items-center space-x-3",children:[_.jsx(x,{className:"w-8 h-8 text-green-600"}),_.jsxs("div",{children:[_.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[s.processingTime?.toFixed(0)||0,"ms"]}),_.jsx("div",{className:"text-sm text-gray-600",children:"Scan Time"})]})]})})]}),s.scan?.neuralAnalysis&&_.jsx(W,{analysis:s.scan.neuralAnalysis}),s.scan?.vulnerabilities&&s.scan.vulnerabilities.length>0&&_.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:[_.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Detected Vulnerabilities (",s.scan.vulnerabilities.length,")"]}),_.jsx("div",{className:"space-y-4",children:s.scan.vulnerabilities.map((e,s)=>_.jsx(V,{vulnerability:e},s))})]}),q.length>0&&_.jsx(Y,{threats:q}),s.recommendations&&s.recommendations.length>0&&_.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:[_.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Security Recommendations"}),_.jsx("div",{className:"space-y-4",children:s.recommendations.map((e,s)=>_.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[_.jsx("h4",{className:"font-semibold text-gray-900",children:e.title}),_.jsx("p",{className:"text-gray-600 text-sm mt-1",children:e.description}),e.actions&&_.jsx("div",{className:"mt-2 space-y-1",children:e.actions.map((e,s)=>_.jsxs("div",{className:"text-sm text-blue-600",children:["• ",e.fix||e.type]},s))})]},s))})]})]})]}),"threats"===L&&_.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[_.jsx(H,{}),_.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:[_.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Threat Statistics (24h)"}),A.length>0?_.jsx(p,{width:"100%",height:200,children:_.jsxs(u,{data:A,children:[_.jsx(j,{strokeDasharray:"3 3"}),_.jsx(g,{dataKey:"severity"}),_.jsx(b,{}),_.jsx(y,{}),_.jsx(N,{dataKey:"count",fill:"#3b82f6"})]})}):_.jsx("div",{className:"text-center py-8 text-gray-500",children:"No threat data available"})]})]}),"compliance"===L&&_.jsx("div",{className:"space-y-6",children:R?_.jsx(z,{compliance:R}):_.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200 text-center",children:[_.jsx(a,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),_.jsx("p",{className:"text-gray-600",children:"Run a security scan to see compliance status"})]})}),"quantum"===L&&_.jsx("div",{className:"space-y-6",children:q.length>0?_.jsx(Y,{threats:q}):_.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200 text-center",children:[_.jsx(c,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),_.jsx("p",{className:"text-gray-600",children:"No quantum vulnerabilities detected"}),_.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Your code appears to be quantum-resistant"})]})})]})]})};function I(){return _.jsxs("div",{className:"min-h-screen bg-gray-100",children:[_.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:_.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:_.jsxs("div",{className:"flex items-center justify-between h-16",children:[_.jsxs("div",{className:"flex items-center space-x-3",children:[_.jsx("div",{className:"text-3xl",children:"🛡️"}),_.jsxs("div",{children:[_.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"PQShield API"}),_.jsx("p",{className:"text-sm text-gray-500",children:"Quantum-Resistant Security Platform"})]})]}),_.jsxs("div",{className:"flex items-center space-x-4",children:[_.jsxs("div",{className:"text-sm text-gray-600",children:[_.jsx("span",{className:"font-medium",children:"Status:"}),_.jsx("span",{className:"ml-1 text-green-600 font-semibold",children:"Secure & Hardened"})]}),_.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"})]})]})})}),_.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:_.jsx(q,{})}),_.jsx("footer",{className:"bg-white border-t border-gray-200 mt-12",children:_.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:_.jsxs("div",{className:"text-center text-sm text-gray-500",children:[_.jsx("p",{children:"PQShield API - Ultimate Quantum-Resistant Security Platform"}),_.jsx("p",{className:"mt-1",children:"🛡️ All Security Vulnerabilities Addressed • Production Ready • Neural Networks Hardened"})]})})})]})}R(document.getElementById("root")).render(_.jsx(e.StrictMode,{children:_.jsx(I,{})}));
